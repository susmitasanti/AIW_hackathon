<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <table class="table table-striped">
        <thead>
          <tr class="table-dark">
            <th scope="col">Sr No.</th>
            <th scope="col">Email</th>
            <th scope="col">Name</th>
            <th scope="col">Type</th>
            <th scope="col">Quantity</th>
            <th scope="col">Cooked On</th>
            <th scope="col">Cooked At</th>


            <th scope="col">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Action</th>

          </tr>
        </thead>
        <tbody>
          <% users.forEach(function(user, index) { %>
        <tr>
          <th scope="row"><%= index + 1 %></th>
          <td><%= user.email %></td>
          <td><%= user.name %></td>
          <td><%= user.type %></td>
          <td><%= user.quantity %></td>
          <td><%= user.cooked_on %></td>
          <td><%= user.cooked_at %></td>
          <td>
            <button type="submit" class="btn btn-success" onclick="Accept(this)" email="<%= user.email %>" food_name="<%= user.name %>" food_type="<%= user.type %>" quantity="<%= user.quantity %>" cooked_on="<%= user.cooked_on %>" cooked_at="<%= user.cooked_at %>" id="accept">Accept</button>
            <!-- <button type="submit" class="btn btn-danger" onclick="Reject(this)">Reject</button> -->

          </td>
        </tr>
        <% }); %>

      </tbody>
      </table>

      <script>
        function Accept(button){
          const email=button.getAttribute('email')
          const food_name=button.getAttribute('food_name')
          const food_type=button.getAttribute('food_type')
          const quantity=button.getAttribute('quantity')
          const cooked_on=button.getAttribute('cooked_on')
          const cooked_at=button.getAttribute('cooked_at')
          const response =fetch(`http://localhost:3000/api/accept?email=${email}&food_name=${food_name}&food_type=${food_type}&quantity=${quantity}&cooked_on=${cooked_on}&cooked_at=${cooked_at}`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json", // Set the content type to JSON
                },
                
            })
            window.location.reload()
            
        }
      </script>
</body>

</html>